# PDF裁切可视化工具使用说明

## 概述

`pdf_crop_visual.py` 是一个图形界面的PDF裁切工具，允许用户可视化地调整PDF裁切参数，实时预览裁切效果。

## 功能特性

- 🖼️ **可视化预览**：实时显示PDF页面和裁切区域
- 🎛️ **交互式调整**：使用滑块和输入框精确调整裁切参数
- 🔍 **自动检测**：智能识别页眉页脚区域
- 📄 **多页浏览**：支持浏览PDF的所有页面
- 💾 **配置管理**：保存和加载裁切配置
- 🎨 **预设模板**：提供常用的裁切预设

## 安装依赖

确保安装了所有必要的依赖包：

```bash
pip install -r requirements.txt
```

主要依赖：
- `PyMuPDF` - PDF处理
- `Pillow` - 图像处理
- `tkinter` - GUI界面（Python标准库）

## 使用方法

### 1. 启动工具

```bash
python3 pdf_crop_visual.py
```

### 2. 基本操作流程

#### 步骤1：选择PDF文件
- 点击「选择PDF文件」按钮
- 选择要裁切的PDF文件
- 工具会自动加载并显示第一页

#### 步骤2：浏览页面
- 使用「上一页」/「下一页」按钮浏览不同页面
- 查看页面信息面板了解页面布局

#### 步骤3：调整裁切参数

**方法一：自动检测**
- 点击「自动检测」按钮
- 工具会自动分析页面布局并设置合适的裁切参数

**方法二：手动调整**
- 使用右侧的滑块调整各边距值
- 或直接在输入框中输入精确数值
- 实时预览裁切效果

**方法三：使用预设**
- 「重置」：清除所有裁切
- 「标准页眉页脚」：适用于一般文档
- 「学术论文」：适用于学术期刊格式

#### 步骤4：预览和应用
- 「预览裁切效果」：查看当前设置的说明
- 「应用裁切」：生成裁切后的PDF文件

### 3. 界面说明

#### 主要区域

1. **顶部控制栏**
   - 文件选择按钮
   - 页面导航控件
   - 自动检测按钮

2. **左侧预览区**
   - PDF页面显示
   - 红色区域：将被裁切的部分
   - 绿色边框：保留的内容区域

3. **右侧参数面板**
   - 裁切参数滑块和输入框
   - 页面信息显示
   - 预设配置按钮

4. **底部操作栏**
   - 预览、应用、保存/加载配置按钮

#### 参数说明

- **顶部边距**：从页面顶部裁切的像素数
- **底部边距**：从页面底部裁切的像素数
- **左侧边距**：从页面左侧裁切的像素数
- **右侧边距**：从页面右侧裁切的像素数

### 4. 配置管理

#### 保存配置
1. 调整好裁切参数后
2. 点击「保存配置」
3. 选择保存位置和文件名
4. 配置将保存为JSON格式

#### 加载配置
1. 点击「加载配置」
2. 选择之前保存的配置文件
3. 参数会自动应用到当前文档

配置文件格式：
```json
{
  "top_margin": 50.0,
  "bottom_margin": 50.0,
  "left_margin": 30.0,
  "right_margin": 30.0
}
```

## 使用技巧

### 1. 精确调整
- 使用滑块进行粗调
- 在输入框中输入精确数值进行细调
- 按回车键或点击其他区域应用输入框中的值

### 2. 多页面检查
- 浏览多个页面确保裁切效果一致
- 不同页面可能有不同的布局，需要找到平衡点

### 3. 自动检测优化
- 自动检测适用于标准格式的文档
- 对于特殊布局，可能需要手动微调
- 检测结果仅供参考，最终效果以预览为准

### 4. 预设配置
- 「标准页眉页脚」：上下50px，左右30px
- 「学术论文」：上下70px，左右50px
- 可以基于预设进行微调

## 与翻译脚本集成

可视化工具确定的裁切参数可以直接用于翻译脚本的配置：

1. 使用可视化工具确定最佳裁切参数
2. 将参数应用到翻译配置文件中：

```json
{
  "pdf_crop": {
    "enable": true,
    "auto_detect_headers": false,
    "margins": {
      "top": 50,
      "bottom": 50,
      "left": 30,
      "right": 30
    }
  }
}
```

3. 运行翻译脚本时会自动应用这些裁切设置

## 故障排除

### 常见问题

**Q: 图像显示模糊**
A: 工具使用2倍缩放提高清晰度，如果仍然模糊，可能是PDF本身分辨率较低

**Q: 裁切区域不准确**
A: 确保在正确的页面上调整参数，不同页面可能需要不同的设置

**Q: 自动检测效果不好**
A: 自动检测基于文本块分析，对于图像较多或布局复杂的PDF可能不够准确，建议手动调整

**Q: 保存的PDF文件过大**
A: 裁切不会显著减小文件大小，如需压缩可使用其他PDF工具

### 错误处理

- 如果遇到「无法打开PDF」错误，检查文件是否损坏或受密码保护
- 如果界面响应缓慢，可能是PDF文件过大，建议先处理较小的文件
- 如果裁切后内容丢失，检查边距设置是否过大

## 技术说明

- 基于PyMuPDF进行PDF处理
- 使用tkinter构建图形界面
- 支持实时预览和交互式调整
- 兼容所有标准PDF格式
- 输出的PDF保持原始质量

## 更新日志

- v1.0.0: 初始版本，支持基本的可视化裁切功能
- 支持自动检测、手动调整、配置管理
- 提供多种预设配置和实时预览